
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Biophysical model &#8212; polyclonal 3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualize antibody mix" href="visualize_RBD.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Biophysical-model">
<h1>Biophysical model<a class="headerlink" href="#Biophysical-model" title="Permalink to this headline">¶</a></h1>
<p>Here we describe the biophysical model of polyclonal antibodies that motivates the approach in this package.</p>
<p>We recommend first reading <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2022.09.17.508366v1">this paper</a> to understand the model conceptually before reading the rest of the documentation.</p>
<section id="Model">
<h2>Model<a class="headerlink" href="#Model" title="Permalink to this headline">¶</a></h2>
<p>Consider a viral protein bound by polyclonal antibodies, such as might be found in sera. We want to determine the contribution of each mutation to escaping these polyclonal antibodies, being cognizant of the fact that different antibodies target different epitopes.</p>
<p>The actual experimental measurable is as follows: at each concentration <span class="math notranslate nohighlight">\(c\)</span> of the antibody mixture, we measure <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>, which is the fraction of all variants <span class="math notranslate nohighlight">\(v\)</span> of the viral protein that escape binding or neutralization (whichever is being experimentally measured) by all antibodies in the mix. For instance, <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span> might be fraction of variants <span class="math notranslate nohighlight">\(v\)</span> that are not neutralized in a virus neutralization deep mutational scanning experiment as in
<a class="reference external" href="https://elifesciences.org/articles/49324">Lee et al (2019)</a>.</p>
<p>We assume that antibodies in the mix can bind to one of <span class="math notranslate nohighlight">\(E\)</span> epitopes on the protein. Let <span class="math notranslate nohighlight">\(U_e\left(v,c\right)\)</span> be the fraction of the time that epitope <span class="math notranslate nohighlight">\(e\)</span> is not bound on variant <span class="math notranslate nohighlight">\(v\)</span> when the mix is at concentration <span class="math notranslate nohighlight">\(c\)</span>. Then assuming antibodies bind independently without competition, the overall experimentally measured fraction of variants that escape binding at concentration <span class="math notranslate nohighlight">\(c\)</span> is simply:</p>
<div class="math notranslate nohighlight">
\[p_v\left(c\right) = \prod_{e=1}^E U_e\left(v, c\right),
\label{pv} \tag{1}\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> ranges over the <span class="math notranslate nohighlight">\(E\)</span> epitopes.</p>
<p>We want to write <span class="math notranslate nohighlight">\(U_e\left(v,c\right)\)</span> in terms of underlying physical properties like the relative concentrations of antibodies targeting different epitopes, and the affinities of these antibodies. If we assume that there is no competition among antibodies binding to different epitopes, that all antibodies targeting a given epitope have same affinity, and that there is no cooperativity in antibody binding (Hill coefficient of antibody binding is one), then the fraction of all variants
<span class="math notranslate nohighlight">\(v\)</span> that are not bound by an antibody targeting epitope <span class="math notranslate nohighlight">\(e\)</span> at concentration <span class="math notranslate nohighlight">\(c\)</span> is given by a Hill equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
U_e\left(v, c\right) &amp;=&amp; \frac{1}{1 + \frac{c f_e}{K_{d,e}\left(v\right)}} \\
&amp;=&amp; \frac{1}{1 + c f_e \exp \left(-\frac{\Delta G_e\left(v\right)}{RT}\right)} \\
&amp;=&amp; \frac{1}{1 + c \exp \left(-\phi_e\left(v\right)\right)}, \\
\label{Ue} \tag{2}
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> represents the total binding activity of antibodies to epitope <span class="math notranslate nohighlight">\(e\)</span> against variant <span class="math notranslate nohighlight">\(v\)</span>, and is related to the free energy of binding <span class="math notranslate nohighlight">\(\Delta G_e\left(v\right)\)</span> and the fraction of antibodies <span class="math notranslate nohighlight">\(f_e\)</span> targeting epitope <span class="math notranslate nohighlight">\(e\)</span> by <span class="math notranslate nohighlight">\(\phi_e\left(v\right) = \frac{\Delta G_e\left(v\right)}{RT} - \ln f_e\)</span>; note that <span class="math notranslate nohighlight">\(RT\)</span> is the product of the molar gas constant and the temperature and
<span class="math notranslate nohighlight">\(K_{d,e}= \exp\left(\frac{\Delta G_e\left(v\right)}{RT}\right)\)</span> is the dissociation constant. The value of <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> depends both on the affinity of antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span> (via <span class="math notranslate nohighlight">\(\Delta G_e\left(v\right)\)</span>) and on the abundance of antibodies with this specificity in the overall mix (via <span class="math notranslate nohighlight">\(f_e\)</span>), and so is a measure of the overall importance of antibodies with this specificity in the polyclonal mix. Smaller (more negative) values of
<span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> correspond to a higher overall contribution of antibodies with specificity for epitope <span class="math notranslate nohighlight">\(e\)</span> to the activity against variant <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>Finally, we want to frame <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> in terms of the actual quantities of biological interest. There are two quantities of biological interest:</p>
<ol class="arabic simple">
<li><p>The activity of antibodies binding epitope <span class="math notranslate nohighlight">\(e\)</span> in the unmutated (“wildtype”) protein background, which will be denoted as <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span>.</p></li>
<li><p>The extent of escape mediated by each amino-acid mutation <span class="math notranslate nohighlight">\(m\)</span> on binding of antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span>, which will be denoted as <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>.</p></li>
</ol>
<p>In order to infer these quantities, we make the assumption that mutations have additive effects on the free energy of binding (and so <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span>) for antibodies targeting any given epitope <span class="math notranslate nohighlight">\(e\)</span>. Specifically, let <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> be the total activity against the “wildtype” protein of antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span>, with larger values of <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> indicating stronger antibody binding (or neutralization) at this epitope. Let <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> be
the extent to which mutation <span class="math notranslate nohighlight">\(m\)</span> (where <span class="math notranslate nohighlight">\(1 \le m \le M\)</span>) reduces binding by antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span>, with larger values of <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> corresponding to more escape from binding (a value of 0 means the mutation has no effect on antibodies targeting this epitope). We can then write:</p>
<div class="math notranslate nohighlight">
\[\phi_e\left(v\right) = -a_{\rm{wt}, e} + \sum_{m=1}^M \beta_{m,e} b\left(v\right)_m
\label{phie} \tag{3}\]</div>
<p>where <span class="math notranslate nohighlight">\(b\left(v\right)_m\)</span> is one if variant <span class="math notranslate nohighlight">\(v\)</span> has mutation <span class="math notranslate nohighlight">\(m\)</span> and 0 otherwise.</p>
<p>These equations relate the quantities of biological interest (<span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> and <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>) to the experimental measurables (<span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>).</p>
</section>
<section id="IC50s-from-the-model">
<h2>IC50s from the model<a class="headerlink" href="#IC50s-from-the-model" title="Permalink to this headline">¶</a></h2>
<p>After we have fit the model parameters (activities and mutation escape values) to the experimental measurables (variant-level escape probabilities at different concentrations), for each variant we can calculate a <span class="math notranslate nohighlight">\(IC_{50}\)</span> (or more generally, an <span class="math notranslate nohighlight">\(IC_x\)</span>), which is the concentration of the polyclonal antibody mix where 50% (or x%, in the more general case) of that particular variant is neutralized.</p>
<p>To do this, we just solve for the <span class="math notranslate nohighlight">\(c\)</span> such that <span class="math notranslate nohighlight">\(p_v\left(c\right) = 1 - x\)</span> where <span class="math notranslate nohighlight">\(x\)</span> is the fraction neutralized, so <span class="math notranslate nohighlight">\(x = 0.5\)</span> for an <span class="math notranslate nohighlight">\(IC_{50}\)</span>. Because <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span> is a monotonically increasing function of <span class="math notranslate nohighlight">\(c\)</span>, this will have a unique solution that we determine numerically.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">polyclonal</h1>
    
  </a>
</p>



<p class="blurb">Model mutational escape from polyclonal antibodies.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=polyclonal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">polyclonal documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize_RBD.html">Visualize antibody mix</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulate_RBD.html">Simulate experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_RBD.html">Fit model to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="regularization.html">Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="RBD_bootstrap.html">Bootstrapping model fits</a></li>
<li class="toctree-l1"><a class="reference internal" href="RBD_average.html">Averaging models</a></li>
<li class="toctree-l1"><a class="reference internal" href="real_LyCoV1404.html">Real antibody data example</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_site_numbering.html">Reference site numbering</a></li>
<li class="toctree-l1"><a class="reference internal" href="real_cocktail.html">Real antibody cocktail example</a></li>
<li class="toctree-l1"><a class="reference internal" href="real_serum.html">Real serum example</a></li>
<li class="toctree-l1"><a class="reference internal" href="specify_epitopes.html">Specifying epitopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="expt_design.html">Experimental design</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Details on fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="partition_function.html">Distinct epitopes assumption</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyclonal.html">polyclonal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="visualize_RBD.html" title="next chapter">Visualize antibody mix</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2022.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/biophysical_model.nblink.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/polyclonal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>