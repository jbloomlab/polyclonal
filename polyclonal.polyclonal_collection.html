
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>polyclonal_collection &#8212; polyclonal 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="utils" href="polyclonal.utils.html" />
    <link rel="prev" title="polyclonal" href="polyclonal.polyclonal.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-polyclonal.polyclonal_collection"></span><section id="polyclonal-collection">
<h1>polyclonal_collection<a class="headerlink" href="#polyclonal-collection" title="Permalink to this headline">¶</a></h1>
<p>Defines <a class="reference internal" href="#polyclonal.polyclonal_collection.PolyclonalCollection" title="polyclonal.polyclonal_collection.PolyclonalCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolyclonalCollection</span></code></a> objects for bootstrapping
<a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> model parameters.</p>
<dl class="py class">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal_collection.</span></span><span class="sig-name descname"><span class="pre">PolyclonalCollection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_polyclonal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#PolyclonalCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A container class for multiple <a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_polyclonal</strong> (<a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a>) – The polyclonal object created with the full dataset to draw bootstrapped
samples from.</p></li>
<li><p><strong>n_bootstrap_samples</strong> (<em>int</em>) – Number of bootstrapped <a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> models to fit.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>n_threads</strong> (<em>int</em>) – The number of threads to use for multiprocessing.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.mutations">
<span class="sig-name descname"><span class="pre">mutations</span></span><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.mutations" title="Permalink to this definition">¶</a></dt>
<dd><p>All mutations for which we have escape values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.models">
<span class="sig-name descname"><span class="pre">models</span></span><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.models" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>n_bootstrap_samples</cite> of <a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.unsampled_mutations">
<span class="sig-name descname"><span class="pre">unsampled_mutations</span></span><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.unsampled_mutations" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary that keeps track of which mutations that are not seen by
at least one model. The keys are the mutations and the values are the
number of models that did not observe the mutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.fit_models">
<span class="sig-name descname"><span class="pre">fit_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#PolyclonalCollection.fit_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.fit_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits <a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> models.
Initializes models with bootstrapped <cite>data_to_fit</cite>, and then fits model.</p>
<p>After fitting, re-initialize <a class="reference internal" href="polyclonal.polyclonal.html#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> without
data, but with inferred parameters.</p>
<p>Save the models without attached data to <a class="reference internal" href="#polyclonal.polyclonal_collection.PolyclonalCollection.models" title="polyclonal.polyclonal_collection.PolyclonalCollection.models"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PolyclonalCollection.models</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_attempts</strong> (<em>int</em>) – The maximum number of retries to allow if optimization fails.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.make_predictions">
<span class="sig-name descname"><span class="pre">make_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variants_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#PolyclonalCollection.make_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.make_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions on variants for models that have parameters for
present mutations.
Aggregate and return these predictions into a single data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variants_df</strong> (<em>pandas.DataFrame</em>) – Data frame defining variants. Should have column named
‘aa_substitutions’ that defines variants as space-delimited strings
of substitutions (e.g., ‘M1A K3T’).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred_dfs</strong> – For each model in the <cite>PolyclonalCollection</cite>, generates a dataframe
of predictions on <cite>variants_df</cite> and returns them in a list.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of pandas.DataFrame objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.mut_bootstrap_freq_dict">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mut_bootstrap_freq_dict</span></span><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.mut_bootstrap_freq_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the mutations and the percentage of
bootstrapped samples they were in.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.summarize_bootstraped_predictions">
<span class="sig-name descname"><span class="pre">summarize_bootstraped_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#PolyclonalCollection.summarize_bootstraped_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.summarize_bootstraped_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate predictions from all eligible models.
Given a list of prediction dataframes, splits each variant up by each
mutation, and calculates summary statistics of escape predictions
associated with each mutation at each concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pred_list</strong> (<em>list of pandas.DataFrame objects</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results_df</strong> – A dataframe of summary stats for predictions made from each model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.PolyclonalCollection.summarize_bootstrapped_params">
<span class="sig-name descname"><span class="pre">summarize_bootstrapped_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#PolyclonalCollection.summarize_bootstrapped_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.PolyclonalCollection.summarize_bootstrapped_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataframe of summary statistics for <cite>self.mut_escape_df</cite>
and <cite>self.activity_wt_df</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>mut_escape_stats_dict</strong> (<em>dict</em>) – A dictionary of dataframes in the format of <cite>self.mut_escape_df</cite>,
but instead have a summary statistic for the beta parameter for the
coresponding mutation. Statistic is given by the key in the object.</p></li>
<li><p><strong>activity_wt_stats_dict</strong> (<em>dict</em>) – A dictionary of dataframes in the format of <cite>self.activity_wt_df</cite>,
but instead have a summary statistic for the beta parameter for the
coresponding mutation. Statistic is given by the key in the object.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="polyclonal.polyclonal_collection.create_bootstrap_sample">
<span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal_collection.</span></span><span class="sig-name descname"><span class="pre">create_bootstrap_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concentration'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal_collection.html#create_bootstrap_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal_collection.create_bootstrap_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bootstrapped sample of a pandas data frame, maintaining the
same number of items when grouped by a given column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – A dataframe to be bootstrapped</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – The random seed to use for the sample</p></li>
<li><p><strong>group_by_col</strong> (<em>string</em><em>, </em><em>list</em><em> or </em><em>None</em>) – The name of a column to group the dataframe by. In most cases, this will
be ‘concentration’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bootstrap_df</strong> – A dataframe that has the same number of rows as <cite>df</cite> as well as the same
number of samples per <cite>group_by_col</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">polyclonal</h1>
    
  </a>
</p>



<p class="blurb">Model mutational escape from polyclonal antibodies.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=polyclonal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">polyclonal documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="biophysical_model.html">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize_RBD.html">Visualize antibody mix</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulate_RBD.html">Simulate experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_RBD.html">Fit model to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="specify_epitopes.html">Specifying epitopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="expt_design.html">Experimental design</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Details on fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="partition_function.html">Distinct epitopes assumption</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="polyclonal.html">polyclonal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="polyclonal.html">polyclonal package</a><ul>
      <li>Previous: <a href="polyclonal.polyclonal.html" title="previous chapter">polyclonal</a></li>
      <li>Next: <a href="polyclonal.utils.html" title="next chapter">utils</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2022.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/polyclonal.polyclonal_collection.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/polyclonal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>