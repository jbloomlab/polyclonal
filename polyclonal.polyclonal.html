
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>polyclonal &#8212; polyclonal 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="utils" href="polyclonal.utils.html" />
    <link rel="prev" title="plot" href="polyclonal.plot.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-polyclonal.polyclonal"></span><section id="polyclonal">
<h1>polyclonal<a class="headerlink" href="#polyclonal" title="Permalink to this headline">¶</a></h1>
<p>Defines <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> objects for handling antibody mixtures.</p>
<dl class="py data">
<dt class="sig sig-object py" id="polyclonal.polyclonal.AAS_NOSTOP">
<span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal.</span></span><span class="sig-name descname"><span class="pre">AAS_NOSTOP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('A',</span> <span class="pre">'C',</span> <span class="pre">'D',</span> <span class="pre">'E',</span> <span class="pre">'F',</span> <span class="pre">'G',</span> <span class="pre">'H',</span> <span class="pre">'I',</span> <span class="pre">'K',</span> <span class="pre">'L',</span> <span class="pre">'M',</span> <span class="pre">'N',</span> <span class="pre">'P',</span> <span class="pre">'Q',</span> <span class="pre">'R',</span> <span class="pre">'S',</span> <span class="pre">'T',</span> <span class="pre">'V',</span> <span class="pre">'W',</span> <span class="pre">'Y')</span></em><a class="headerlink" href="#polyclonal.polyclonal.AAS_NOSTOP" title="Permalink to this definition">¶</a></dt>
<dd><p>Amino-acid one-letter codes alphabetized, doesn’t include stop.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal.</span></span><span class="sig-name descname"><span class="pre">Polyclonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activity_wt_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mut_escape_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_to_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epitopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('A',</span> <span class="pre">'C',</span> <span class="pre">'D',</span> <span class="pre">'E',</span> <span class="pre">'F',</span> <span class="pre">'G',</span> <span class="pre">'H',</span> <span class="pre">'I',</span> <span class="pre">'K',</span> <span class="pre">'L',</span> <span class="pre">'M',</span> <span class="pre">'N',</span> <span class="pre">'P',</span> <span class="pre">'Q',</span> <span class="pre">'R',</span> <span class="pre">'S',</span> <span class="pre">'T',</span> <span class="pre">'V',</span> <span class="pre">'W',</span> <span class="pre">'Y')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epitope_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#1f77b4',</span> <span class="pre">'#ff7f0e',</span> <span class="pre">'#2ca02c',</span> <span class="pre">'#d62728',</span> <span class="pre">'#9467bd',</span> <span class="pre">'#8c564b',</span> <span class="pre">'#e377c2',</span> <span class="pre">'#bcbd22',</span> <span class="pre">'#17becf')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_mut_escape_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exact_match'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represent polyclonal antibody mixtures targeting multiple epitopes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At several concentrations <span class="math notranslate nohighlight">\(c\)</span> of an antibody mixture, we measure
<span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>, the probability that variant <span class="math notranslate nohighlight">\(v\)</span> is
<strong>not</strong> bound (or neutralized). We assume antibodies act independently on
one of <span class="math notranslate nohighlight">\(E\)</span> epitopes, so the probability <span class="math notranslate nohighlight">\(U_e\left(v, c\right)\)</span>
that <span class="math notranslate nohighlight">\(v\)</span> is unbound at concentration <span class="math notranslate nohighlight">\(c\)</span> is related to the
probability that epitope <span class="math notranslate nohighlight">\(e\)</span> is unbound by</p>
<div class="math notranslate nohighlight" id="equation-p-v">
<span class="eqno">(1)<a class="headerlink" href="#equation-p-v" title="Permalink to this equation">¶</a></span>\[p_v\left(c\right) = \prod_{e=1}^E U_e\left(v, c\right).\]</div>
<p>We furthermore assume that <span class="math notranslate nohighlight">\(U_e\left(v, c\right)\)</span> is related to the
total binding activity <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> of antibodies targeting
epitope <span class="math notranslate nohighlight">\(e\)</span> on variant <span class="math notranslate nohighlight">\(v\)</span> by</p>
<div class="math notranslate nohighlight" id="equation-u-e">
<span class="eqno">(2)<a class="headerlink" href="#equation-u-e" title="Permalink to this equation">¶</a></span>\[U_e\left(v,c\right)=\frac{1}{1+c\exp\left(-\phi_e\left(v\right)\right)}\]</div>
<p>where smaller (more negative) values of <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span>
correspond to higher overall binding activity against epitope <span class="math notranslate nohighlight">\(e\)</span>
variant <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>We define <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> in terms of the underlying
quantities of biological interest as</p>
<div class="math notranslate nohighlight" id="equation-phi">
<span class="eqno">(3)<a class="headerlink" href="#equation-phi" title="Permalink to this equation">¶</a></span>\[\phi_e\left(v\right) = -a_{\rm{wt}, e} +
                       \sum_{m=1}^M \beta_{m,e} b\left(v\right)_m,\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> is the activity of the serum against
epitope <span class="math notranslate nohighlight">\(e\)</span> for the “wildtype” (unmutated) protein (larger values
indicate higher activity against this epitope), <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>
is the extent to which mutation <span class="math notranslate nohighlight">\(m\)</span> (where <span class="math notranslate nohighlight">\(1 \le m \le M\)</span>)
escapes binding from antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span> (larger
values indicate more escape by this mutation), and
<span class="math notranslate nohighlight">\(b\left(v\right)_m\)</span> is 1 if variant <span class="math notranslate nohighlight">\(v\)</span> has mutation <span class="math notranslate nohighlight">\(m\)</span>
and 0 otherwise.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can initialize a <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> object in three ways:</p>
<ol class="arabic simple">
<li><p>With known epitope activities <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> and mutation-escape
values <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>, and no data. Use this approach if you
already know these values and just want to visualize the polyclonal
antibody mixture properties or predict escape of variants. To do this,
initialize with <code class="docutils literal notranslate"><span class="pre">activity_wt_df</span></code> and <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> storing the
known values, and <code class="docutils literal notranslate"><span class="pre">data_to_fit=None</span></code>.</p></li>
<li><p>With data to fit the epitope activities and mutation-escape values,
and initial guesses for the epitope activities and mutation-escape
values. To do this, initialize with <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code> holding the data,
and <code class="docutils literal notranslate"><span class="pre">activity_wt_df</span></code> and <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> holding initial guesses
for these values, ensuring guesses in <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> encompass
same mutations as <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>. Then call <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal.fit" title="polyclonal.polyclonal.Polyclonal.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Polyclonal.fit()</span></code></a>.</p></li>
<li><p>With data to fit the epitope activities and mutation-escape values,
but no initial guesses. To do this, initialize with <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>
holding the data, <code class="docutils literal notranslate"><span class="pre">activity_wt_df=None</span></code>, <code class="docutils literal notranslate"><span class="pre">mut_escape_df=None</span></code>,
and <code class="docutils literal notranslate"><span class="pre">n_epitopes</span></code> holding the number of epitopes. Then call
<a class="reference internal" href="#polyclonal.polyclonal.Polyclonal.fit" title="polyclonal.polyclonal.Polyclonal.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Polyclonal.fit()</span></code></a>.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_to_fit</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – Should have columns named ‘aa_substitutions’, ‘concentration’, and
‘prob_escape’. The ‘aa_substitutions’ column defines each variant
<span class="math notranslate nohighlight">\(v\)</span> as a string of substitutions (e.g., ‘M3A K5G’). The
‘prob_escape’ column gives the <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span> value for
each variant at each concentration <span class="math notranslate nohighlight">\(c\)</span>.</p></li>
<li><p><strong>activity_wt_df</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – Should have columns named ‘epitope’ and ‘activity’, giving the names
of the epitopes and the activity against epitope in the wildtype
protein, <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span>.</p></li>
<li><p><strong>mut_escape_df</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – Should have columns named ‘mutation’, ‘epitope’, and ‘escape’ that
give the <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> values (in the ‘escape’ column), with
mutations written like “G7M”.</p></li>
<li><p><strong>n_epitopes</strong> (<em>int</em><em> or </em><em>None</em>) – If initializing with <code class="docutils literal notranslate"><span class="pre">activity_wt_df=None</span></code>, specifies number
of epitopes.</p></li>
<li><p><strong>alphabet</strong> (<em>array-like</em>) – Allowed characters in mutation strings.</p></li>
<li><p><strong>epitope_colors</strong> (<em>array-like</em><em> or </em><em>dict</em>) – Maps each epitope to the color used for plotting. Either a dict keyed
by each epitope, or an array of colors that are sequentially assigned
to the epitopes.</p></li>
<li><p><strong>init_missing</strong> (<em>'zero'</em><em> or </em><em>int</em>) – How to to initialize any activities or mutation-escape values not
specified in <code class="docutils literal notranslate"><span class="pre">activity_wt_df</span></code> or <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code>. If ‘zero’,
set to zero. Otherwise draw uniformly from between 0 and 1 using
specified random number seed.</p></li>
<li><p><strong>data_mut_escape_overlap</strong> (<em>{'exact_match'</em><em>, </em><em>'fill_to_data'}</em>) – If <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> are both specified,
what to do if they don’t specify same sites / wildtypes / mutations.
If ‘exact_match’, raise error. If ‘fill_to_data’, then take
sites / wildtypes / mutations from <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code> and fill init
values from any not specified in <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> as indicated by
<code class="docutils literal notranslate"><span class="pre">init_missing</span></code>–still raise error if values in <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code>
are not in <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.epitopes">
<span class="sig-name descname"><span class="pre">epitopes</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.epitopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all epitopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mutations">
<span class="sig-name descname"><span class="pre">mutations</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mutations" title="Permalink to this definition">¶</a></dt>
<dd><p>All mutations for which we have escape values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.alphabet">
<span class="sig-name descname"><span class="pre">alphabet</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.alphabet" title="Permalink to this definition">¶</a></dt>
<dd><p>Allowed characters in mutation strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.sites">
<span class="sig-name descname"><span class="pre">sites</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.sites" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.wts">
<span class="sig-name descname"><span class="pre">wts</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.wts" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyed by site, value is wildtype at that site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.epitope_colors">
<span class="sig-name descname"><span class="pre">epitope_colors</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.epitope_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps each epitope to its color.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.data_to_fit">
<span class="sig-name descname"><span class="pre">data_to_fit</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.data_to_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Data to fit as passed when initializing this <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryMap</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Example</p>
<p>Simple example with two epitopes (<cite>e1</cite> and <cite>e2</cite>) and a few mutations where
we know the activities and mutation-level escape values ahead of time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">activity_wt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;epitope&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;e1&#39;</span><span class="p">,</span> <span class="s1">&#39;e2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="s1">&#39;activity&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">2.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mut_escape_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>     <span class="s1">&#39;mutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;M1C&#39;</span><span class="p">,</span> <span class="s1">&#39;M1A&#39;</span><span class="p">,</span> <span class="s1">&#39;M1A&#39;</span><span class="p">,</span> <span class="s1">&#39;M1C&#39;</span><span class="p">,</span> <span class="s1">&#39;A2K&#39;</span><span class="p">,</span> <span class="s1">&#39;A2K&#39;</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;epitope&#39;</span><span class="p">:</span>  <span class="p">[</span> <span class="s1">&#39;e1&#39;</span><span class="p">,</span>  <span class="s1">&#39;e2&#39;</span><span class="p">,</span>  <span class="s1">&#39;e1&#39;</span><span class="p">,</span>  <span class="s1">&#39;e2&#39;</span><span class="p">,</span>  <span class="s1">&#39;e1&#39;</span><span class="p">,</span>  <span class="s1">&#39;e2&#39;</span><span class="p">],</span>
<span class="gp">... </span>     <span class="s1">&#39;escape&#39;</span><span class="p">:</span>   <span class="p">[</span>  <span class="mf">2.0</span><span class="p">,</span>   <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">3.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">0.0</span><span class="p">,</span>   <span class="mf">2.5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span> <span class="o">=</span> <span class="n">Polyclonal</span><span class="p">(</span><span class="n">activity_wt_df</span><span class="o">=</span><span class="n">activity_wt_df</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">mut_escape_df</span><span class="o">=</span><span class="n">mut_escape_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">epitopes</span>
<span class="go">(&#39;e1&#39;, &#39;e2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">mutations</span>
<span class="go">(&#39;M1A&#39;, &#39;M1C&#39;, &#39;A2K&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">sites</span>
<span class="go">(1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">wts</span>
<span class="go">{1: &#39;M&#39;, 2: &#39;A&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">activity_wt_df</span>
<span class="go">  epitope  activity</span>
<span class="go">0      e1       2.0</span>
<span class="go">1      e2       1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">mut_escape_df</span>
<span class="go">  epitope  site wildtype mutant mutation  escape</span>
<span class="go">0      e1     1        M      A      M1A     3.0</span>
<span class="go">1      e1     1        M      C      M1C     2.0</span>
<span class="go">2      e1     2        A      K      A2K     0.0</span>
<span class="go">3      e2     1        M      A      M1A     0.0</span>
<span class="go">4      e2     1        M      C      M1C     0.0</span>
<span class="go">5      e2     2        A      K      A2K     2.5</span>
</pre></div>
</div>
<p>We can also summarize the mutation-level escape at the site level:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal</span><span class="o">.</span><span class="n">mut_escape_site_summary_df</span>
<span class="go">  epitope  site wildtype  mean  total positive  max  min  total negative</span>
<span class="go">0      e1     1        M   2.5             5.0  3.0  2.0             0.0</span>
<span class="go">1      e1     2        A   0.0             0.0  0.0  0.0             0.0</span>
<span class="go">2      e2     1        M   0.0             0.0  0.0  0.0             0.0</span>
<span class="go">3      e2     2        A   2.5             2.5  2.5  2.5             0.0</span>
</pre></div>
</div>
<p>Note that we can <strong>not</strong> initialize a <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> object if we are
missing escape estimates for any mutations for any epitopes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Polyclonal</span><span class="p">(</span><span class="n">activity_wt_df</span><span class="o">=</span><span class="n">activity_wt_df</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">mut_escape_df</span><span class="o">=</span><span class="n">mut_escape_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">invalid set of mutations for epitope=&#39;e2&#39;</span>
</pre></div>
</div>
<p>Now make a data frame with some variants:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variants_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">[(</span><span class="s1">&#39;AA&#39;</span><span class="p">,</span> <span class="s1">&#39;A2K&#39;</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="s1">&#39;AC&#39;</span><span class="p">,</span> <span class="s1">&#39;M1A A2K&#39;</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s1">&#39;M1A&#39;</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;A2K&#39;</span><span class="p">)],</span>
<span class="gp">... </span>        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;barcode&#39;</span><span class="p">,</span> <span class="s1">&#39;aa_substitutions&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Get the escape probabilities predicted on these variants from
the values in the <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">escape_probs</span> <span class="o">=</span> <span class="n">polyclonal</span><span class="o">.</span><span class="n">prob_escape</span><span class="p">(</span><span class="n">variants_df</span><span class="o">=</span><span class="n">variants_df</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">concentrations</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">escape_probs</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">   barcode aa_substitutions  concentration  predicted_prob_escape</span>
<span class="go">0       AA              A2K            1.0                  0.097</span>
<span class="go">1       AC          M1A A2K            1.0                  0.598</span>
<span class="go">2       AG              M1A            1.0                  0.197</span>
<span class="go">3       AT                             1.0                  0.032</span>
<span class="go">4       CA              A2K            1.0                  0.097</span>
<span class="go">5       AA              A2K            2.0                  0.044</span>
<span class="go">6       AC          M1A A2K            2.0                  0.398</span>
<span class="go">7       AG              M1A            2.0                  0.090</span>
<span class="go">8       AT                             2.0                  0.010</span>
<span class="go">9       CA              A2K            2.0                  0.044</span>
<span class="go">10      AA              A2K            4.0                  0.017</span>
<span class="go">11      AC          M1A A2K            4.0                  0.214</span>
<span class="go">12      AG              M1A            4.0                  0.034</span>
<span class="go">13      AT                             4.0                  0.003</span>
<span class="go">14      CA              A2K            4.0                  0.017</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<p>Initialize with <code class="docutils literal notranslate"><span class="pre">escape_probs</span></code> created above as data to fit. In order
to do this, we need to change the name of the column with the
predicted escape probs to just be escape probs as we are now assuming
these are the real values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_to_fit</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>        <span class="n">escape_probs</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;predicted_prob_escape&#39;</span><span class="p">:</span> <span class="s1">&#39;prob_escape&#39;</span><span class="p">})</span>
<span class="gp">... </span>        <span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data</span> <span class="o">=</span> <span class="n">Polyclonal</span><span class="p">(</span><span class="n">data_to_fit</span><span class="o">=</span><span class="n">data_to_fit</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">n_epitopes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The mutations are those in <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data</span><span class="o">.</span><span class="n">mutations</span>
<span class="go">(&#39;M1A&#39;, &#39;A2K&#39;)</span>
</pre></div>
</div>
<p>The activities and mutation escapes are all initialized to zero:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data</span><span class="o">.</span><span class="n">activity_wt_df</span>
<span class="go">     epitope  activity</span>
<span class="go">0  epitope 1       0.0</span>
<span class="go">1  epitope 2       0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data</span><span class="o">.</span><span class="n">mut_escape_df</span>
<span class="go">     epitope  site wildtype mutant mutation  escape</span>
<span class="go">0  epitope 1     1        M      A      M1A     0.0</span>
<span class="go">1  epitope 1     2        A      K      A2K     0.0</span>
<span class="go">2  epitope 2     1        M      A      M1A     0.0</span>
<span class="go">3  epitope 2     2        A      K      A2K     0.0</span>
</pre></div>
</div>
<p>You can initialize to random numbers by setting <code class="docutils literal notranslate"><span class="pre">init_missing</span></code> to seed:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Polyclonal</span><span class="p">(</span><span class="n">data_to_fit</span><span class="o">=</span><span class="n">data_to_fit</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">n_epitopes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">init_missing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>           <span class="p">)</span><span class="o">.</span><span class="n">activity_wt_df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">     epitope  activity</span>
<span class="go">0  epitope 1     0.417</span>
<span class="go">1  epitope 2     0.720</span>
</pre></div>
</div>
<p>You set some or all mutation escapes to initial values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data2</span> <span class="o">=</span> <span class="n">Polyclonal</span><span class="p">(</span>
<span class="gp">... </span>           <span class="n">data_to_fit</span><span class="o">=</span><span class="n">data_to_fit</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">activity_wt_df</span><span class="o">=</span><span class="n">activity_wt_df</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">mut_escape_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;epitope&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;e1&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="s1">&#39;mutation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;M1A&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="s1">&#39;escape&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]}),</span>
<span class="gp">... </span>           <span class="n">data_mut_escape_overlap</span><span class="o">=</span><span class="s1">&#39;fill_to_data&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polyclonal_data2</span><span class="o">.</span><span class="n">mut_escape_df</span>
<span class="go">  epitope  site wildtype mutant mutation  escape</span>
<span class="go">0      e1     1        M      A      M1A     4.0</span>
<span class="go">1      e1     2        A      K      A2K     0.0</span>
<span class="go">2      e2     1        M      A      M1A     0.0</span>
<span class="go">3      e2     2        A      K      A2K     0.0</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.activity_wt_barplot">
<span class="sig-name descname"><span class="pre">activity_wt_barplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.activity_wt_barplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.activity_wt_barplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bar plot of activity against each epitope, <span class="math notranslate nohighlight">\(a_{\rm{wt},e}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword args for <a class="reference internal" href="polyclonal.plot.html#polyclonal.plot.activity_wt_barplot" title="polyclonal.plot.activity_wt_barplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyclonal.plot.activity_wt_barplot()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.activity_wt_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">activity_wt_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.activity_wt_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Activities <span class="math notranslate nohighlight">\(a_{\rm{wt,e}}\)</span> for epitopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Not yet implemented.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mut_escape_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> for each mutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_heatmap">
<span class="sig-name descname"><span class="pre">mut_escape_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Heatmaps of the mutation escape values, <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword args for <a class="reference internal" href="polyclonal.plot.html#polyclonal.plot.mut_escape_heatmap" title="polyclonal.plot.mut_escape_heatmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyclonal.plot.mut_escape_heatmap()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive heat maps.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_lineplot">
<span class="sig-name descname"><span class="pre">mut_escape_lineplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_lineplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_lineplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plots of mutation escape <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> at each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword args for <a class="reference internal" href="polyclonal.plot.html#polyclonal.plot.mut_escape_lineplot" title="polyclonal.plot.mut_escape_lineplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyclonal.plot.mut_escape_lineplot()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_pdb_b_factor">
<span class="sig-name descname"><span class="pre">mut_escape_pdb_b_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_pdbfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{metric}-{epitope}.pdb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_pdb_b_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_pdb_b_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PDB files with B factors from a site’s mutation escape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_pdbfile</strong> (<em>str</em>) – Path to input PDB file.</p></li>
<li><p><strong>chains</strong> (<em>str</em><em> or </em><em>array-like</em>) – Single chain or list of them to re-color.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Which site-level summary metric to use. Can be any metric in
<a class="reference internal" href="#polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df" title="polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyclonal.mut_escape_site_summary_df</span></code></a>.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Output directory for created PDB files.</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name, with formatting used to replace metric and
epitope in curly brackets.</p></li>
<li><p><strong>missing_metric</strong> (<em>float</em><em> or </em><em>dict</em>) – How do we handle sites in PDB that are missing in escape metric?
If a float, reassign B factors for all missing sites to this value.
If a dict, should be keyed by chain and assign all missing sites in
each chain to indicated value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives name of created B-factor re-colored PDB for each epitope.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mut_escape_site_summary_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Site-level summaries of mutation escape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.prob_escape">
<span class="sig-name descname"><span class="pre">prob_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variants_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentrations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.prob_escape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.prob_escape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute predicted probability of escape <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>.</p>
<p>Computed using current mutation-escape values <span class="math notranslate nohighlight">\(beta_{m,e}\)</span> and
epitope activities <span class="math notranslate nohighlight">\(a_{\rm{wt},e}\)</span> stored in this
<a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variants_df</strong> (<em>pandas.DataFrame</em>) – Input data frame defining variants. Should have a column
named ‘aa_substitutions’ that definese variants as space-delimited
strings of substitutions (e.g., ‘M1A K3T’).</p></li>
<li><p><strong>concentrations</strong> (<em>array-like</em>) – Concentrations at which we compute probability of escape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A copy of <code class="docutils literal notranslate"><span class="pre">variants_df</span></code> with new columns named ‘concentration’
and ‘predicted_prob_escape’ giving predicted probability of escape
<span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span> for each variant at each concentration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">polyclonal</h1>
    
  </a>
</p>



<p class="blurb">Model mutational escape from polyclonal antibodies.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=polyclonal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">polyclonal documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="biophysical_model.html">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulate_RBD.html">Simulate antibody mix</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="polyclonal.html">polyclonal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="polyclonal.html">polyclonal package</a><ul>
      <li>Previous: <a href="polyclonal.plot.html" title="previous chapter">plot</a></li>
      <li>Next: <a href="polyclonal.utils.html" title="next chapter">utils</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2021.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/polyclonal.polyclonal.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/polyclonal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>