
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>polyclonal &#8212; polyclonal 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="utils" href="polyclonal.utils.html" />
    <link rel="prev" title="pdb_utils" href="polyclonal.pdb_utils.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-polyclonal.polyclonal"></span><section id="polyclonal">
<h1>polyclonal<a class="headerlink" href="#polyclonal" title="Permalink to this headline">¶</a></h1>
<p>Defines <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> objects for handling antibody mixtures.</p>
<dl class="py data">
<dt class="sig sig-object py" id="polyclonal.polyclonal.AAS_NOSTOP">
<span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal.</span></span><span class="sig-name descname"><span class="pre">AAS_NOSTOP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('A',</span> <span class="pre">'C',</span> <span class="pre">'D',</span> <span class="pre">'E',</span> <span class="pre">'F',</span> <span class="pre">'G',</span> <span class="pre">'H',</span> <span class="pre">'I',</span> <span class="pre">'K',</span> <span class="pre">'L',</span> <span class="pre">'M',</span> <span class="pre">'N',</span> <span class="pre">'P',</span> <span class="pre">'Q',</span> <span class="pre">'R',</span> <span class="pre">'S',</span> <span class="pre">'T',</span> <span class="pre">'V',</span> <span class="pre">'W',</span> <span class="pre">'Y')</span></em><a class="headerlink" href="#polyclonal.polyclonal.AAS_NOSTOP" title="Permalink to this definition">¶</a></dt>
<dd><p>Amino-acid one-letter codes alphabetized, doesn’t include stop.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">polyclonal.polyclonal.</span></span><span class="sig-name descname"><span class="pre">Polyclonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activity_wt_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mut_escape_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_to_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epitopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('A',</span> <span class="pre">'C',</span> <span class="pre">'D',</span> <span class="pre">'E',</span> <span class="pre">'F',</span> <span class="pre">'G',</span> <span class="pre">'H',</span> <span class="pre">'I',</span> <span class="pre">'K',</span> <span class="pre">'L',</span> <span class="pre">'M',</span> <span class="pre">'N',</span> <span class="pre">'P',</span> <span class="pre">'Q',</span> <span class="pre">'R',</span> <span class="pre">'S',</span> <span class="pre">'T',</span> <span class="pre">'V',</span> <span class="pre">'W',</span> <span class="pre">'Y')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epitope_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('#1f77b4',</span> <span class="pre">'#ff7f0e',</span> <span class="pre">'#2ca02c',</span> <span class="pre">'#d62728',</span> <span class="pre">'#9467bd',</span> <span class="pre">'#8c564b',</span> <span class="pre">'#e377c2',</span> <span class="pre">'#bcbd22',</span> <span class="pre">'#17becf')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represent polyclonal antibody mixtures targeting multiple epitopes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At several concentrations <span class="math notranslate nohighlight">\(c\)</span> of an antibody mixture, we measure
<span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>, the probability that variant <span class="math notranslate nohighlight">\(v\)</span> is
<strong>not</strong> bound (or neutralized). We assume antibodies act independently on
one of <span class="math notranslate nohighlight">\(E\)</span> epitopes, so the probability <span class="math notranslate nohighlight">\(U_e\left(v, c\right)\)</span>
that <span class="math notranslate nohighlight">\(v\)</span> is unbound at concentration <span class="math notranslate nohighlight">\(c\)</span> is related to the
probability that epitope <span class="math notranslate nohighlight">\(e\)</span> is unbound by</p>
<div class="math notranslate nohighlight" id="equation-p-v">
<span class="eqno">(1)<a class="headerlink" href="#equation-p-v" title="Permalink to this equation">¶</a></span>\[p_v\left(c\right) = \prod_{e=1}^E U_e\left(v, c\right).\]</div>
<p>We furthermore assume that <span class="math notranslate nohighlight">\(U_e\left(v, c\right)\)</span> is related to the
total binding activity <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> of antibodies targeting
epitope <span class="math notranslate nohighlight">\(e\)</span> on variant <span class="math notranslate nohighlight">\(v\)</span> by</p>
<div class="math notranslate nohighlight" id="equation-u-e">
<span class="eqno">(2)<a class="headerlink" href="#equation-u-e" title="Permalink to this equation">¶</a></span>\[U_e\left(v,c\right)=\frac{1}{1+c\exp\left(-\phi_e\left(v\right)\right)}\]</div>
<p>where smaller (more negative) values of <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span>
correspond to higher overall binding activity against epitope <span class="math notranslate nohighlight">\(e\)</span>
variant <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>We define <span class="math notranslate nohighlight">\(\phi_e\left(v\right)\)</span> in terms of the underlying
quantities of biological interest as</p>
<div class="math notranslate nohighlight" id="equation-phi">
<span class="eqno">(3)<a class="headerlink" href="#equation-phi" title="Permalink to this equation">¶</a></span>\[\phi_e\left(v\right) = -a_{\rm{wt}, e} +
                       \sum_{m=1}^M \beta_{m,e} b\left(v\right)_m,\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span> is the activity of the serum against
epitope <span class="math notranslate nohighlight">\(e\)</span> for the “wildtype” (unmutated) protein (larger values
indicate higher activity against this epitope), <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>
is the extent to which mutation <span class="math notranslate nohighlight">\(m\)</span> (where <span class="math notranslate nohighlight">\(1 \le m \le M\)</span>)
escapes binding from antibodies targeting epitope <span class="math notranslate nohighlight">\(e\)</span> (larger
values indicate more escape by this mutation), and
<span class="math notranslate nohighlight">\(b\left(v\right)_m\)</span> is 1 if variant <span class="math notranslate nohighlight">\(v\)</span> has mutation <span class="math notranslate nohighlight">\(m\)</span>
and 0 otherwise.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can initialize a <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal" title="polyclonal.polyclonal.Polyclonal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyclonal</span></code></a> object in three ways:</p>
<ol class="arabic simple">
<li><p>With known epitope activities :<cite>a_{rm{wt}, e}</cite> and mutation-escape
values <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>, and no data. Use this approach if you
already know these values and just want to visualize the polyclonal
antibody mixture properties or predict escape of variants. To do this,
initialize with <code class="docutils literal notranslate"><span class="pre">activity_wt_df</span></code> and <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> storing the
known values, and <code class="docutils literal notranslate"><span class="pre">data_to_fit=None</span></code>.</p></li>
<li><p>With data to fit the epitope activities and mutation-escape values,
and initial guesses for the epitope activities and mutation-escape
values. To do this, initialize with <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code> holding the data,
and <code class="docutils literal notranslate"><span class="pre">activity_wt_df</span></code> and <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> holding initial guesses
for these values, ensuring guesses in <code class="docutils literal notranslate"><span class="pre">mut_escape_df</span></code> encompass
same mutations as <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>. Then call <a class="reference internal" href="#polyclonal.polyclonal.Polyclonal.fit" title="polyclonal.polyclonal.Polyclonal.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Polyclonal.fit()</span></code></a>.</p></li>
<li><p>With data to fit the epitope activities and mutation-escape values,
but no initial guesses. To do this, initialize with <code class="docutils literal notranslate"><span class="pre">data_to_fit</span></code>
holding the data, <code class="docutils literal notranslate"><span class="pre">activity_wt_df=None</span></code>, <code class="docutils literal notranslate"><span class="pre">mut_escape_df=None</span></code>,
and <cite>n_epitopes`</cite> holding the number of epitopes. Then call
<span class="math notranslate nohighlight">\(Polyclonal.fit\)</span>.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_to_fit</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – <strong>ADD THIS</strong></p></li>
<li><p><strong>activity_wt_df</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – Should have columns named ‘epitope’ and ‘activity’, giving the names
of the epitopes and the activity against epitope in the wildtype
protein, <span class="math notranslate nohighlight">\(a_{\rm{wt}, e}\)</span>.</p></li>
<li><p><strong>mut_escape_df</strong> (<em>pandas.DataFrame</em><em> or </em><em>None</em>) – Should have columns named ‘mutation’, ‘epitope’, and ‘escape’ that
give the <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> values (in the ‘escape’ column).</p></li>
<li><p><strong>n_epitopes</strong> (<em>int</em><em> or </em><em>None</em>) – If initializing with <code class="docutils literal notranslate"><span class="pre">activity_wt_df=None</span></code>, specifies number
of epitopes.</p></li>
<li><p><strong>alphabet</strong> (<em>array-like</em>) – Allowed characters in mutation strings.</p></li>
<li><p><strong>epitope_colors</strong> (<em>array-like</em><em> or </em><em>dict</em>) – Maps each epitope to the color used for plotting. Either a dict keyed
by each epitope, or an array of colors that are sequentially assigned
to the epitopes.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.epitopes">
<span class="sig-name descname"><span class="pre">epitopes</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.epitopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all epitopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mutations">
<span class="sig-name descname"><span class="pre">mutations</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mutations" title="Permalink to this definition">¶</a></dt>
<dd><p>All mutations for which we have escape values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.alphabet">
<span class="sig-name descname"><span class="pre">alphabet</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.alphabet" title="Permalink to this definition">¶</a></dt>
<dd><p>Allowed characters in mutation strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.sites">
<span class="sig-name descname"><span class="pre">sites</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.sites" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.wts">
<span class="sig-name descname"><span class="pre">wts</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.wts" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyed by site, value is wildtype at that site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.epitope_colors">
<span class="sig-name descname"><span class="pre">epitope_colors</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.epitope_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps each epitope to its color.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Example</span> <span class="pre">with</span> <span class="pre">known</span> <span class="pre">epitope</span> <span class="pre">activities</span> <span class="pre">and</span> <span class="pre">mutation</span> <span class="pre">escape</span> <span class="pre">values</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">----------------------------------------------------------------</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">A</span> <span class="pre">simple</span> <span class="pre">example</span> <span class="pre">with</span> <span class="pre">two</span> <span class="pre">epitopes</span> <span class="pre">(`e1`</span> <span class="pre">and</span> <span class="pre">`e2`)</span> <span class="pre">and</span> <span class="pre">a</span> <span class="pre">small</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">mutations</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">activity_wt_df</span> <span class="pre">=</span> <span class="pre">pd.DataFrame({'epitope'</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[‘e1’, ‘e2’],</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'activity'</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[ 2.0,  1.0]})</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">mut_escape_df</span> <span class="pre">=</span> <span class="pre">pd.DataFrame({</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">'mutation'</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[‘M1C’, ‘M1A’, ‘M1A’, ‘M1C’, ‘A2K’, ‘A2K’],</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">'epitope'</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[ ‘e1’,  ‘e2’,  ‘e1’,  ‘e2’,  ‘e1’,  ‘e2’],</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">'escape'</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>[  2.0,   0.0,   3.0,  0.0,   0.0,   2.5]})</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal</span> <span class="pre">=</span> <span class="pre">Polyclonal(activity_wt_df=activity_wt_df,</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">mut_escape_df=mut_escape_df)</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.epitopes</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">('e1',</span> <span class="pre">'e2')</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.mutations</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">('M1A',</span> <span class="pre">'M1C',</span> <span class="pre">'A2K')</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.sites</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">(1,</span> <span class="pre">2)</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.wts</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">{1</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>‘M’, 2: ‘A’}</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.activity_wt_df</span></span></dt>
<dd><p>epitope  activity</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">0</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">1</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.mut_escape_df</span></span></dt>
<dd><p>epitope  site wildtype mutant mutation  escape</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">0</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span>&#160;&#160;&#160;&#160; <span class="pre">3.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">1</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">C</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">M1C</span>&#160;&#160;&#160;&#160; <span class="pre">2.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">2</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">K</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">3</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span>&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">4</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">C</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">M1C</span>&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">5</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">K</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160; <span class="pre">2.5</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">We</span> <span class="pre">can</span> <span class="pre">also</span> <span class="pre">summarize</span> <span class="pre">the</span> <span class="pre">mutation-level</span> <span class="pre">escape</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">site</span> <span class="pre">level</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.mut_escape_site_summary_df</span></span></dt>
<dd><p>epitope  site wildtype  mean  total positive  max  min  total negative</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">0</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160; <span class="pre">2.5</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5.0</span>&#160; <span class="pre">3.0</span>&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">1</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e1</span>&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160; <span class="pre">0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span>&#160; <span class="pre">0.0</span>&#160; <span class="pre">0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">2</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M</span>&#160;&#160; <span class="pre">0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span>&#160; <span class="pre">0.0</span>&#160; <span class="pre">0.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">3</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">e2</span>&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span>&#160;&#160; <span class="pre">2.5</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.5</span>&#160; <span class="pre">2.5</span>&#160; <span class="pre">2.5</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.0</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Note</span> <span class="pre">that</span> <span class="pre">we</span> <span class="pre">can</span> <span class="pre">**not**</span> <span class="pre">initialize</span> <span class="pre">a</span> <span class="pre">:class:`Polyclonal`</span> <span class="pre">object</span> <span class="pre">if</span> <span class="pre">we</span> <span class="pre">are</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">missing</span> <span class="pre">escape</span> <span class="pre">estimates</span> <span class="pre">for</span> <span class="pre">any</span> <span class="pre">mutations</span> <span class="pre">for</span> <span class="pre">any</span> <span class="pre">epitopes</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">Polyclonal(activity_wt_df=activity_wt_df,</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">mut_escape_df=mut_escape_df.head(n=5))</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.Traceback">
<span class="sig-name descname"><span class="pre">Traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">most</span> <span class="pre">recent</span> <span class="pre">call</span> <span class="pre">last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.Traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>…</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.ValueError">
<span class="sig-name descname"><span class="pre">ValueError</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.ValueError" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>not all expected mutations for e2</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Now</span> <span class="pre">make</span> <span class="pre">a</span> <span class="pre">data</span> <span class="pre">frame</span> <span class="pre">with</span> <span class="pre">some</span> <span class="pre">variants</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">variants_df</span> <span class="pre">=</span> <span class="pre">pd.DataFrame.from_records(</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[('AA',</span> <span class="pre">'A2K'),</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">('AC',</span> <span class="pre">'M1A</span> <span class="pre">A2K'),</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">('AG',</span> <span class="pre">'M1A'),</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">('AT',</span> <span class="pre">''),</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">('CA',</span> <span class="pre">'A2K')],</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">columns=['barcode',</span> <span class="pre">'aa_substitutions'])</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Get</span> <span class="pre">the</span> <span class="pre">escape</span> <span class="pre">probabilities</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">polyclonal.prob_escape(variants_df=variants_df,</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">concentrations=[1,</span> <span class="pre">2,</span> <span class="pre">4]).round(3)</span></span></dt>
<dd><p>barcode aa_substitutions  concentration  prob_escape</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.097</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AC</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span> <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.598</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AG</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.197</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AT</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.032</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">CA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.097</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">5</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.044</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">6</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AC</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span> <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.398</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">7</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AG</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.090</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">8</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AT</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.010</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">9</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">CA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.044</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">10</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.017</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">11</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AC</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span> <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.214</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">12</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AG</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M1A</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.034</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">13</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">AT</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.003</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">14</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">CA</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A2K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0.017</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.activity_wt_barplot">
<span class="sig-name descname"><span class="pre">activity_wt_barplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epitopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">110</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_per_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.activity_wt_barplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.activity_wt_barplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bar plot of activity against each epitope, <span class="math notranslate nohighlight">\(a_{\rm{wt},e}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epitopes</strong> (<em>array-like</em><em> or </em><em>None</em>) – Include these epitopes in this order. If <cite>None</cite>, use all epitopes.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – Width of plot.</p></li>
<li><p><strong>height_per_bar</strong> (<em>float</em>) – Height of plot for each bar (epitope).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.activity_wt_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">activity_wt_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.activity_wt_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Activities <span class="math notranslate nohighlight">\(a_{\rm{wt,e}}\)</span> for epitopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Not yet implemented.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mut_escape_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> for each mutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_heatmap">
<span class="sig-name descname"><span class="pre">mut_escape_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epitopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_color_at_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_heatmap_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom_bar_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Heatmaps of the mutation escape values, <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epitopes</strong> (<em>array-like</em><em> or </em><em>None</em>) – Make plots for these epitopes. If <cite>None</cite>, use all epitopes.</p></li>
<li><p><strong>alphabet</strong> (<em>array-like</em><em> or </em><em>None</em>) – Order to plot alphabet letters (e.g., amino acids). If <cite>None</cite>, same
order as <cite>alphabet</cite> used to initialize this <cite>Polyclonal</cite> object.</p></li>
<li><p><strong>all_sites</strong> (<em>bool</em>) – Plot all sites in range from first to last site even if some
have no data.</p></li>
<li><p><strong>all_alphabet</strong> (<em>bool</em>) – Plot all letters in the alphabet (e.g., amino acids) even if some
have no data.</p></li>
<li><p><strong>floor_color_at_zero</strong> (<em>bool</em>) – Set lower limit to color scale as zero, even if there are negative
values or if minimum is &gt;0.</p></li>
<li><p><strong>share_heatmap_lims</strong> (<em>bool</em>) – If <cite>True</cite>, let all epitopes share the same limits in color scale.
If <cite>False</cite>, scale each epitopes colors to the min and max escape
values for that epitope.</p></li>
<li><p><strong>cell_size</strong> (<em>float</em>) – Size of cells in heatmap.</p></li>
<li><p><strong>zoom_bar_width</strong> (<em>float</em>) – Width of zoom bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive heat maps.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_lineplot">
<span class="sig-name descname"><span class="pre">mut_escape_lineplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epitopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">900</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom_bar_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_lineplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_lineplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plots of mutation escape <span class="math notranslate nohighlight">\(\beta_{m,e}\)</span> at each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epitopes</strong> (<em>array-like</em><em> or </em><em>None</em>) – Make plots for these epitopes. If <cite>None</cite>, use all epitopes.</p></li>
<li><p><strong>all_sites</strong> (<em>bool</em>) – Plot all sites in range from first to last site even if some
have no data.</p></li>
<li><p><strong>share_ylims</strong> (<em>bool</em>) – Should plots for all epitopes share same y-limits?</p></li>
<li><p><strong>height</strong> (<em>float</em>) – Height per facet.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – Width of plot.</p></li>
<li><p><strong>init_metric</strong> (<em>str</em>) – Metric to show initially (others can be selected by dropdown).
One of metrics in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyclonal.site_summary_df</span></code>.</p></li>
<li><p><strong>zoom_bar_width</strong> (<em>float</em>) – Width of zoom bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Interactive plot.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>altair.Chart</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_pdb_b_factor">
<span class="sig-name descname"><span class="pre">mut_escape_pdb_b_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_pdbfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{metric}-{epitope}.pdb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.mut_escape_pdb_b_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_pdb_b_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PDB files with B factors from a site’s mutation escape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_pdbfile</strong> (<em>str</em>) – Path to input PDB file.</p></li>
<li><p><strong>chains</strong> (<em>str</em><em> or </em><em>array-like</em>) – Single chain or list of them to re-color.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Which site-level summary metric to use. Can be any metric in
<a class="reference internal" href="#polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df" title="polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Polyclonal.mut_escape_site_summary_df</span></code></a>.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Output directory for created PDB files.</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name, with formatting used to replace metric and
epitope in curly brackets.</p></li>
<li><p><strong>missing_metric</strong> (<em>float</em><em> or </em><em>dict</em>) – How do we handle sites in PDB that are missing in escape metric?
If a float, reassign B factors for all missing sites to this value.
If a dict, should be keyed by chain and assign all missing sites in
each chain to indicated value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives name of created B-factor re-colored PDB for each epitope.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mut_escape_site_summary_df</span></span><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.mut_escape_site_summary_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Site-level summaries of mutation escape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="polyclonal.polyclonal.Polyclonal.prob_escape">
<span class="sig-name descname"><span class="pre">prob_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variants_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentrations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substitutions_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aa_substitutions'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentration_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concentration'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_escape_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prob_escape'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/polyclonal/polyclonal.html#Polyclonal.prob_escape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#polyclonal.polyclonal.Polyclonal.prob_escape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute probability of escape <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variants_df</strong> (<em>pandas.DataFrame</em>) – Input data frame defining variants and concentrations.</p></li>
<li><p><strong>concentrations</strong> (<em>array-like</em>) – Concentrations at which we compute probability of escape.</p></li>
<li><p><strong>substitutions_col</strong> (<em>str</em>) – Column in <cite>variants_df</cite> defining variants as space-delimited
strings of substitutions (e.g., ‘M1A K3T’).</p></li>
<li><p><strong>concentration_col</strong> (<em>str</em>) – Column in returned data frame with concentrations.</p></li>
<li><p><strong>prob_escape_col</strong> (<em>str</em>) – Column in returned data frame with <span class="math notranslate nohighlight">\(p_v\left(c\right)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A copy of <cite>variants_df</cite> with <cite>concentration_col</cite> and
<cite>prob_escape_col</cite> added, giving the probability of escape
(<span class="math notranslate nohighlight">\(_v\left(c\right)\)</span>) values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">polyclonal</h1>
    
  </a>
</p>



<p class="blurb">Model mutational escape from polyclonal antibodies.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=polyclonal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">polyclonal documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="biophysical_model.html">Biophysical model</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulate_RBD.html">Simulate antibody mix</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="polyclonal.html">polyclonal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="polyclonal.html">polyclonal package</a><ul>
      <li>Previous: <a href="polyclonal.pdb_utils.html" title="previous chapter">pdb_utils</a></li>
      <li>Next: <a href="polyclonal.utils.html" title="next chapter">utils</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2021.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/polyclonal.polyclonal.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/polyclonal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>